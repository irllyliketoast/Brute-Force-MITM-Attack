### Brute-Force-MITM-Attack

**Objective**: I co-authored the article "Advanced Persistent Threats and WLAN Security: An In-depth Exploration of Attack Surfaces and Mitigation Techniques" with Dr. Hosam Alamleh, Dr. Shadman Sakib Arnob, and Dr. Ali Abdullah S. AlQahtan. My contributions focused on the attack surface analysis, where I conducted testing of man-in-the-middle and dictionary attacks on Wi-Fi networks, including the KRACK and Downgrade Attacks.

**Abstract**: In the contemporary digital landscape, Wi-Fi-enabled Wireless Local Area Networks (WLANs) play an indispensable role in
facilitating connectivity, witnessing a significant proliferation of Wi-Fi devices worldwide. Given their critical function in supporting
several activities, ensuring the security of WLANs stands as a paramount concern. This paper conducts an in-depth analysis of
the attack surface of WLANs, categorizing it into three primary areas: the radio access network, compromised insider nodes, and
the gateway to the Internet service provider. Furthermore, the paper explores how attacks on these surfaces can be amplified
or made more potent through the resources wielded by Advanced Persistent Threats (APTs), which pose substantial risks to
individuals and organizations. Through meticulous examination and experimentation, we assess the efficacy of current WLAN
implementations in mitigating APTs and pinpoint essential characteristics necessary for constructing resilient future implementations.
Our findings underscore the formidable challenge of safeguarding WLANs from APTs due to their expansive attack surface. We
discuss techniques aimed at enhancing the security of current Wi-Fi implementations, thereby increasing the difficulty of successful
attacks. However, achieving complete security for such networks remains highly challenging. Additionally, we deliberate on future
design implementations geared towards bolstering the security of WLANs in the forthcoming year.

**Code**: This script was done in Python and can be run through Kali Linux. You may run this code with any word lists you'd like- it can handle up to 4. 
This program generates a *custom password dictionary* file by combining words from up to four user-specified files with numbers and special characters to create all possible permutations. It works by first loading the words from the files, stripping any whitespace, and storing them in lists. It then generates a list of three-digit numbers ranging from 000 to 999, along with a set of special characters like `!`, `@`, `#`, and so on.
Next, the program creates 2-word, 3-word, and 4-word combinations by selecting words from the user-provided files. For 2-word combinations, it pairs words from different files and creates every possible arrangement (like "catred" or "dogblue"). For 3-word and 4-word combinations, it generates all possible groupings of words from the selected files.
Once these combinations are created, the program appends numbers and special characters to each word combination. This includes attaching the numbers before, after, and within the word combinations. For example, "catdog" could be transformed into "catdog123" or "123catdog". Special characters are also inserted before, after, and in between the combinations to create more variations, such as "catdog$123" or "$catdog123".
Finally, all of these permutations are written to a file called *dictionary.txt*. This output file serves as a comprehensive password list, often used in security testing, brute-force attacks, or password-cracking exercises. The program ensures that combinations are as diverse as possible, accounting for multiple arrangements of words, numbers, and special characters. This script is a practical example of *combinatorics*, *file manipulation*, and *string formatting* in Python.

**Attack**: To run a Wi-Fi password cracking script through Kali Linux, you would typically target the network's authentication process, which employs pre-shared keys (PSK) susceptible to both online and offline attacks. Online attacks are conducted in real time, interacting directly with the network. Using tools like Aircrack-ng, an attacker would capture data packets during Wi-Fi activity and attempt to guess the password using methods such as dictionary or brute-force attacks. These attempts are limited by network traffic and the access point's ability to handle multiple authentication requests, making them slower and more detectable. In contrast, offline attacks are more efficient and discreet. These attacks begin with capturing the 4-way handshake, a critical process that occurs when a client connects to a Wi-Fi network. Tools like Airodump-ng in Kali Linux can capture this handshake, which contains essential cryptographic elements such as the Anonce (random number from the access point), Snonce (random number from the client), PMK (Pairwise Master Key), and PTK (Pairwise Transient Key). Once the handshake is captured, it can be used to conduct an offline dictionary or brute-force attack with tools like Hashcat or John the Ripper. Since the attack is no longer dependent on live network activity, it can be executed much faster using the full computational power of the attacker's system. Advanced attack methods, such as the KRACK (Key Reinstallation Attack), exploit vulnerabilities in the WPA2 protocol's implementation rather than its encryption. By replaying parts of the 4-way handshake, the attacker can force the victim to reinstall an already-used encryption key, ultimately allowing decryption of intercepted traffic. This is especially dangerous since it can be conducted without requiring the victim's password. Moreover, downgrade attacks can be used to coerce devices into switching from WPA3 to the less secure WPA2, making it easier to exploit known vulnerabilities. To scale such attacks, especially when transitioning from an online to an offline approach, additional computing resources are utilized. For example, attackers may use GPU-based cracking with tools like Hashcat to significantly increase the speed of password guesses. Brute-force attacks, while computationally expensive, can still be effective depending on password complexity. Dictionary attacks, on the other hand, use precompiled lists of common passwords, making them faster but less effective if the target's password is unique. In summary, Kali Linux offers a range of tools to facilitate online and offline Wi-Fi password cracking, with offline methods being faster, stealthier, and more efficient due to their reliance on local computational power rather than live network activity.
